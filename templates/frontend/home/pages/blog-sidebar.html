{% extends "frontend/layout/master.html" %}
{% load static %}

{% block content %}
<style>
  .pagination .page-link {
    color: #ff7e01;
    padding: 12px 20px;
    margin: 0 5px;
    border-radius: 50%;
    border: 1px solid #ff7e01;
    transition: all 0.3s ease;
  }
  
  .pagination .page-link:hover,
  .pagination .page-item.active .page-link {
    background-color: #ff7e01;
    color: white;
    border-color: #ff7e01;
  }

  .pagination .page-item:first-child .page-link,
  .pagination .page-item:last-child .page-link {
    border-radius: 50%;
  }

  .load-more-btn {
    background-color: #ff7e01;
    color: white;
    padding: 12px 30px;
    border-radius: 30px;
    border: 2px solid #ff7e01;
    font-size: 16px;
    font-weight: 500;
    transition: all 0.3s ease;
    display: inline-block;
    text-decoration: none;
  }
  
  .load-more-btn:hover {
    background-color: transparent;
    color: #ff7e01;
  }

  .load-more-btn i {
    margin-right: 8px;
  }

  .blog-card {
    height: 100%;
    display: flex;
    flex-direction: column;
  }
  
  .blog-card .card-img {
    position: relative;
    width: 100%;
    height: 300px;
    overflow: hidden;
  }
  
  .blog-card .card-img img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  .blog-card .card-body {
    flex: 1;
    display: flex;
    flex-direction: column;
  }
  
  .blog-card .card-title {
    margin-top: auto;
    margin-bottom: 15px;
  }
</style>

<section class="breadcrumb-area bread-bg-9">
  <div class="breadcrumb-wrap">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-6">
          <div class="breadcrumb-content">
            <div class="section-heading">
              <h2 class="sec__title text-white">Blog Sidebar</h2>
            </div>
          </div>
          <!-- end breadcrumb-content -->
        </div>
        <!-- end col-lg-6 -->
        <div class="col-lg-6">
          <div class="breadcrumb-list text-end">
            <ul class="list-items">
              <li><a href="{{home:index}}">Home</a></li>
              <li>Blog</li>
              <li>Blog Sidebar</li>
            </ul>
          </div>
          <!-- end breadcrumb-list -->
        </div>
        <!-- end col-lg-6 -->
      </div>
      <!-- end row -->
    </div>
    <!-- end container -->
  </div>
  <!-- end breadcrumb-wrap -->
  <div class="bread-svg-box">
    <svg
      class="bread-svg"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 100 10"
      preserveAspectRatio="none"
    >
      <polygon points="100 0 50 10 0 0 0 10 100 10"></polygon>
    </svg>
  </div>
  <!-- end bread-svg -->
</section>
<!-- end breadcrumb-area -->
<!-- ================================
END BREADCRUMB AREA
================================= -->

<!-- ================================
START CARD AREA
================================= -->
<section class="card-area section--padding">
  <div class="container">
    <div class="row">
      <div class="col-lg-8">
        <div class="row">
          {% for post in posts %}
          <div class="col-lg-6 responsive-column">
            <a href="{% url 'blog:post_detail' post.slug %}" class="text-decoration-none">
              <div class="card-item blog-card">
                <div class="card-img">
                  {% if post.image %}
                  <img src="{{ post.image.url }}" alt="{{ post.title }}" />
                  {% else %}
                  <img src="{% static 'images/blog-img.jpg' %}" alt="{{ post.title }}" />
                  {% endif %}
                  <div class="post-format icon-element">
                    <i class="la la-photo"></i>
                  </div>
                  <div class="card-body">
                    <div class="post-categories">
                      {% if post.category %}
                      <span class="badge">{{ post.category.name }}</span>
                      {% endif %}
                    </div>
                    <h3 class="card-title line-height-26 text-white" style="font-size: 22px; font-weight: 600;">
                      {{ post.title }}
                    </h3>
                    <p class="card-meta">
                      <span class="post__date">{{ post.published_at|date }}</span>
                    </p>
                  </div>
                </div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                  <div class="author-content d-flex align-items-center">
                    <div class="author-img">
                      {% if post.author.profile_image %}
                      <img src="{{ post.author.profile_image.url }}" alt="{{ post.author.username }}" />
                      {% else %}
                      <img src="{% static 'images/small-team1.jpg' %}" alt="{{ post.author.username }}" />
                      {% endif %}
                    </div>
                    <div class="author-bio">
                      <span class="author__title text-dark">{{ post.author.username }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </a>
          </div>
          {% endfor %}
        </div>
        <!-- end row -->
        {% if posts.has_previous or posts.has_next %}
        <div class="row">
          <div class="col-lg-12 text-center mt-4">
            {% if posts.has_previous %}
            <a href="?page={{ posts.previous_page_number }}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.tag %}&tag={{ request.GET.tag }}{% endif %}" class="load-more-btn me-2">
              <i class="la la-angle-right"></i> المقالات السابقة
            </a>
            {% endif %}
            {% if posts.has_next %}
            <a href="?page={{ posts.next_page_number }}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.tag %}&tag={{ request.GET.tag }}{% endif %}" class="load-more-btn">
              <i class="la la-refresh"></i> عرض المزيد
            </a>
            {% endif %}
          </div>
        </div>
        {% endif %}
      </div>
      <!-- end col-lg-8 -->
      <div class="col-lg-4">
        <div class="sidebar mb-0">
          <div class="sidebar-widget">
            <h3 class="title stroke-shape">بحث آخر</h3>
            <div class="contact-form-action">
              <form action="#">
                <div class="input-box">
                  <div class="form-group mb-0">
                    <input
                      class="form-control ps-3"
                      type="text"
                      placeholder="اكتب كلماتك الرئيسية ..."
                    />
                    <button class="search-btn" type="submit">
                      <i class="la la-search"></i>
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </div>
          <!-- end sidebar-widget -->
          <div class="sidebar-widget">
            <h3 class="title stroke-shape">التصنيفات</h3>
            <div class="sidebar-category">
              {% for category in categories %}
              <div class="custom-checkbox">
                <input type="checkbox" class="form-check-input" id="cat{{ category.id }}" 
                       {% if request.GET.category|add:"0" == category.id %}checked{% endif %}
                       onclick="window.location.href='{% if request.GET.category|add:"0" == category.id %}?{% else %}?category={{ category.id }}{% endif %}'">
                <label for="cat{{ category.id }}">
                  {{ category.name }} <span class="font-size-13 ms-1">({{ category.post_set.count }})</span>
                </label>
              </div>
              {% endfor %}
            </div>
          </div>
          <!-- end sidebar-widget -->
          <div class="sidebar-widget">
            <div class="section-tab section-tab-2 pb-3">
              <ul class="nav nav-tabs justify-content-center" id="myTab3" role="tablist">
                <li class="nav-item">
                  <a class="nav-link {% if current_tab == 'recent' %}active{% endif %}" 
                     id="recent-tab" href="?tab=recent" role="tab">
                    الأخيرة
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link {% if current_tab == 'popular' or not current_tab %}active{% endif %}" 
                     id="popular-tab" href="?tab=popular" role="tab">
                    جمع
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link {% if current_tab == 'new' %}active{% endif %}" 
                     id="new-tab" href="?tab=new" role="tab">
                    جديد
                  </a>
                </li>
              </ul>
            </div>
            <div class="tab-content" id="myTabContent">
              <div class="tab-pane fade show active">
                {% for post in filtered_posts %}
                <div class="card-item card-item-list recent-post-card {% if forloop.last %}mb-0{% endif %}">
                  <div class="card-img">
                    <a href="{% url 'blog:post_detail' post.slug %}" class="d-block">
                      {% if post.image %}
                      <img src="{{ post.image.url }}" alt="{{ post.title }}" />
                      {% else %}
                      <img src="{% static 'images/blog-img.jpg' %}" alt="{{ post.title }}" />
                      {% endif %}
                    </a>
                  </div>
                  <div class="card-body">
                    <h3 class="card-title">
                      <a href="{% url 'blog:post_detail' post.slug %}">{{ post.title }}</a>
                    </h3>
                    <p class="card-meta">
                      <span class="post__date">{{ post.published_at|date }}</span>
                      <span class="post-dot"></span>
                      <span class="post__time">{{ post.views }} مشاهدة</span>
                    </p>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
          <!-- end sidebar-widget -->
          <div class="sidebar-widget">
            <h3 class="title stroke-shape">أرشيف</h3>
            <div class="sidebar-list">
              <ul class="list-items">
                {% for archive in archive_data %}
                <li>
                  <i class="la la-dot-circle me-2 text-color"></i>
                  <a href="?year={{ archive.year }}&month={{ archive.month|date:'n' }}">
                    {% with month_name=archive.month|date:'F' %}
                    {% if month_name == 'January' %}يناير
                    {% elif month_name == 'February' %}فبراير
                    {% elif month_name == 'March' %}مارس
                    {% elif month_name == 'April' %}أبريل
                    {% elif month_name == 'May' %}مايو
                    {% elif month_name == 'June' %}يونيو
                    {% elif month_name == 'July' %}يوليو
                    {% elif month_name == 'August' %}أغسطس
                    {% elif month_name == 'September' %}سبتمبر
                    {% elif month_name == 'October' %}أكتوبر
                    {% elif month_name == 'November' %}نوفمبر
                    {% elif month_name == 'December' %}ديسمبر
                    {% endif %}
                    {{ archive.year }}
                    {% endwith %}
                    <span class="mr-2">({{ archive.count }})</span>
                  </a>
                </li>
                {% endfor %}
              </ul>
            </div>
          </div>
          <!-- end sidebar-widget -->
          <div class="sidebar-widget">
            <h3 class="title stroke-shape">سحابة الوسم</h3>
            <ul class="tag-list">
              {% for tag in tags %}
              <li>
                <a href="?tag={{ tag.id }}" 
                   class="{% if request.GET.tag|stringformat:'s' == tag.id|stringformat:'s' %}active{% endif %}"
                   style="{% if request.GET.tag|stringformat:'s' == tag.id|stringformat:'s' %}background-color: #ff7e01; color: white; border-color: #ff7e01;{% endif %}">
                  {{ tag.name }}
                </a>
              </li>
              {% endfor %}
              {% if request.GET.tag %}
              <li>
                <a href="?" class="text-danger"><i class="la la-times"></i> إزالة الفلتر</a>
              </li>
              {% endif %}
            </ul>
          </div>
          <!-- end sidebar-widget -->
          <div class="sidebar-widget">
            <h3 class="title stroke-shape">معلومات عنا</h3>
            <div class="sidebar-about">
              <div class="sidebar-about-img">
                <img src="images/destination-img3.jpg" alt="" />
                <p class="font-size-28 font-weight-bold text-white">
                  Trizen
                </p>
              </div>
              <p class="pt-3">
                لكن لا بد لي من أن أوضح لكم كيف ولدت كل هذه الفكرة الخاطئة ،
                وأشرح التعاليم الفعلية للمستكشف العظيم للحيوية ، حتى تكون
                لذة المجهود العظيم ، والحزن:
              </p>
            </div>
          </div>
          <!-- end sidebar-widget -->
          <div class="sidebar-widget">
            <h3 class="title stroke-shape">اتبع واتصل</h3>
            <ul class="social-profile">
              <li>
                <a href="#"><i class="lab la-facebook-f"></i></a>
              </li>
              <li>
                <a href="#"><i class="lab la-twitter"></i></a>
              </li>
              <li>
                <a href="#"><i class="lab la-instagram"></i></a>
              </li>
              <li>
                <a href="#"><i class="lab la-linkedin-in"></i></a>
              </li>
            </ul>
          </div>
          <!-- end sidebar-widget -->
        </div>
        <!-- end sidebar -->
      </div>
      <!-- end col-lg-4 -->
    </div>
    <!-- end row -->
  </div>
  <!-- end container -->
</section>
<!-- end card-area -->
<!-- ================================
END CARD AREA
================================= -->

<div class="section-block"></div>

<!-- ================================
START INFO AREA
================================= -->
<section class="info-area info-bg padding-top-90px padding-bottom-70px">
  <div class="container">
    <div class="row">
      <div class="col-lg-4 responsive-column">
        <a href="#" class="icon-box icon-layout-2 d-flex">
          <div class="info-icon flex-shrink-0 bg-rgb text-color-2">
            <i class="la la-phone"></i>
          </div>
          <!-- end info-icon-->
          <div class="info-content">
            <h4 class="info__title">تحتاج مساعدة؟ اتصل بنا</h4>
            <p class="info__desc">جزر لوريم إيبسوم ، حسومات معززة</p>
          </div>
          <!-- end info-content --> </a
        ><!-- end icon-box -->
      </div>
      <!-- end col-lg-4 -->
      <div class="col-lg-4 responsive-column">
        <a href="#" class="icon-box icon-layout-2 d-flex">
          <div class="info-icon flex-shrink-0 bg-rgb-2 text-color-3">
            <i class="la la-money"></i>
          </div>
          <!-- end info-icon-->
          <div class="info-content">
            <h4 class="info__title">المدفوعات</h4>
            <p class="info__desc">جزر لوريم إيبسوم ، حسومات معززة</p>
          </div>
          <!-- end info-content --> </a
        ><!-- end icon-box -->
      </div>
      <!-- end col-lg-4 -->
      <div class="col-lg-4 responsive-column">
        <a href="#" class="icon-box icon-layout-2 d-flex">
          <div class="info-icon flex-shrink-0 bg-rgb-3 text-color-4">
            <i class="la la-times"></i>
          </div>
          <!-- end info-icon-->
          <div class="info-content">
            <h4 class="info__title">سياسة الإلغاء</h4>
            <p class="info__desc">جزر لوريم إيبسوم ، حسومات معززة</p>
          </div>
          <!-- end info-content --> </a
        ><!-- end icon-box -->
      </div>
      <!-- end col-lg-4 -->
    </div>
    <!-- end row -->
  </div>
  <!-- end container -->
</section>
<!-- end info-area -->
<!-- ================================
END INFO AREA
================================= -->


{% endblock content %}